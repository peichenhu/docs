(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24f047d0"],{"1c1b":function(t,e,a){},"369f":function(t,e,a){"use strict";var i=a("1c1b"),n=a.n(i);n.a},"6bb1":function(t,e,a){},"8a2e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"securityMonitor"},[a("div",{staticClass:"btns"},[a("span",{class:!t.isChina&&"active",on:{click:t.switchMap}},[t._v("\n      世界\n    ")]),a("span",{class:t.isChina&&"active",on:{click:t.switchMap}},[t._v("\n      中国\n    ")])]),a("TOP",{attrs:{title:"安全事件监控"}}),a("PROGRESS",{staticClass:"box_progress",attrs:{listApp:t.listApp,listIP:t.listIP}}),a("TABLE",{ref:"table",attrs:{title:"威胁实时监控"}}),a("div",{staticClass:"left box_num"},[a("div",{staticClass:"right"},[a("router-link",{staticClass:"title link",attrs:{to:{name:"attackAnalysis"}}},[t._v("高危攻击")]),a("count-to",{staticClass:"number",attrs:{innerSpan:!0,"start-val":0,"end-val":t.highAttackNum,separator:""}})],1),a("div",{staticClass:"left"},[a("router-link",{staticClass:"title link",attrs:{tag:"div",to:{name:"appAnalysis"}}},[t._v("高危应用")]),a("count-to",{staticClass:"number",attrs:{innerSpan:!0,"start-val":0,"end-val":t.highAppNum,separator:""}})],1)]),a("div",{staticClass:"right box_num"},[a("div",{staticClass:"right"},[a("router-link",{staticClass:"title link",attrs:{tag:"div",to:{name:"attackAnalysis"}}},[t._v("拦截攻击")]),a("count-to",{staticClass:"number",attrs:{innerSpan:!0,"start-val":0,"end-val":t.interceptAttackNum,separator:""}})],1),a("div",{staticClass:"left"},[a("router-link",{staticClass:"title link",attrs:{tag:"div",to:{name:"attackAnalysis"}}},[t._v("黑客数量")]),a("count-to",{staticClass:"number",attrs:{innerSpan:!0,"start-val":0,"end-val":t.hackersNum,separator:""}})],1)]),a("div",{staticClass:"box_pie"},[a("router-link",{staticClass:"title link",attrs:{to:{name:"attackAnalysis"}}},[t._v("\n      威胁类型分布\n    ")]),a("v-chart",{ref:"pie",staticClass:"pie",attrs:{options:t.pieOpts}})],1),a("div",{staticClass:"box_line"},[a("router-link",{staticClass:"title link",attrs:{to:{name:"attackAnalysis"}}},[t._v("\n      攻击趋势\n    ")]),a("v-chart",{ref:"line",staticClass:"line",attrs:{options:t.lineOpts}})],1),a("v-chart",{ref:"map",staticClass:"map",attrs:{options:t.mapOpts}})],1)},n=[],s=(a("456d"),a("7f7f"),a("a481"),a("ac6a"),a("4e7a")),r=a("c4cb"),o=function(t){for(var e=[],a=0;a<t.length;a++){var i=t[a],n=r[i[1].name],s=r[i[0].name];n&&s&&e.push({fromName:i[1].name,toName:i[0].name,coords:[n,s]})}return e},l=function(t,e){var a={high:"rgba(241, 25, 56, 0.6)",medium:"rgba(250, 116, 26, 0.7)",low:"rgba(255, 196, 27, 0.7)"},i=t.map((function(t){return{name:t.name,coord:r[t.name],itemStyle:{color:a[t.level]}}})),n=e.map((function(t){return{name:t.name,value:r[t.name],data:e}}));return{name:"攻击源",type:"effectScatter",coordinateSystem:"geo",zlevel:2,tooltip:{formatter:function(t){var e=t.data.data.filter((function(e){return t.data.name===e.name}));if(e&&e.length>3){var a=0,i=0,n=0;return e.forEach((function(t){a+=t.high,i+=t.medium,n+=t.low})),"共计  ".concat(e.length," 个站点，位于 ").concat(t.data.name,"<br/>\n                            高危: ").concat(a,"<br/>\n                            中危: ").concat(i,"<br/>\n                            低危: ").concat(n,"\n                            ")}var s=[];return e.forEach((function(t){s.push("\n                            ".concat(t.site," 站点位于 ").concat(t.name,"<br/>\n                            高危: ").concat(t.high,"<br/>\n                            中危: ").concat(t.medium,"<br/>\n                            低危: ").concat(t.low,"\n                            "))})),s.join("<br/><br/>")}},rippleEffect:{brushType:"stroke"},itemStyle:{normal:{color:"white"}},markPoint:{symbol:"circle",symbolSize:10,data:i},data:n}},c=function(t,e){var a={high:{name:"高危",color:"rgba(241, 25, 56, 0.6)"},medium:{name:"中危",color:"rgba(250, 116, 26, 0.7)"},low:{name:"低危",color:"rgba(255, 196, 27, 0.7)"}};return{name:a[e].name,type:"lines",zlevel:1,effect:{show:!0,period:15,trailLength:.3,color:a[e].color,symbolSize:5,constantSpeed:20},tooltip:{show:!1},lineStyle:{normal:{color:a[e].color,width:.3,curveness:.2,shadowColor:"rgba(0, 0, 0, 0.5)",shadowBlur:10}},data:o(t)}},p={map:"world",label:{emphasis:{show:!1}},top:"15%",left:"15%",right:"5%",bottom:"15%",zoom:1,roam:!1,itemStyle:{normal:{areaColor:"#2e539d",borderColor:"#1b236f"},emphasis:{areaColor:"#2e539d"}},regions:[{name:"China",selected:!0,itemStyle:{emphasis:{areaColor:"#4882EE"}},label:{emphasis:{show:!1}}}]},h={map:"china",label:{emphasis:{show:!1}},top:"12%",left:"24%",right:"8%",bottom:"15%",zoom:1,roam:!1,itemStyle:{normal:{areaColor:"#2e539d",borderColor:"#1b236f"},emphasis:{areaColor:"#2e539d"}}},u={tooltip:{trigger:"item"},geo:p,series:[]},m=[" rgba(127, 36, 239, 1)"," rgba(179, 85, 233, 1)"," rgba(211, 77, 121, 1)"," rgba(194, 67, 77,  1)"," rgba(247, 153, 55, 1)"," rgba(251, 193, 46, 1)"," rgba(212, 223, 90, 1)"," rgba(40, 190, 115, 1)"," rgba(120, 195, 197,1)"," rgba(3, 174, 235,  1)"," rgba(81, 139, 233, 1)"],d=function(t){var e=[];return Object.keys(t).forEach((function(a,i){var n={name:a,value:t[a]},s=m[i%11],r=s.replace("1)","0.3)");n.itemStyle={color:r,borderColor:s,emphasis:{color:s}},n.labelLine={lineStyle:{color:s}},n.label={borderRadius:0,borderWidth:1,borderColor:s,backgroundColor:r,formatter:["{b|{b}}","{hr|}","{c|{c}}"].join("\n"),rich:{hr:{borderColor:s,width:"100%",borderWidth:.5,height:0},b:{width:80,color:"#fff",align:"center",padding:[2,6]},c:{color:"#fff",width:80,align:"center",padding:[2,6]}}},e.push(n)})),e},f={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},color:m,series:[{name:"威胁类型分布",type:"pie",selectedMode:"single",minAngle:120,avoidLabelOverlap:!0,radius:[0,"35%"],label:{formatter:"{b}\n{c}",position:"inner"},labelLine:{show:!1},data:[{value:0,name:"高危攻击",itemStyle:{color:"#0A2AEF"}},{value:0,name:"中危攻击",itemStyle:{color:"#2A6AFF"}},{value:0,name:"低危攻击",itemStyle:{color:"#4D8CFF"}}]},{name:"威胁类型分布",type:"pie",minAngle:10,avoidLabelOverlap:!0,radius:["42%","55%"],data:[]}]},v=[],b=[Math.ceil(500*Math.random())],g=new Date;function y(t){g=[g.getFullYear(),g.getMonth()+1,g.getDate()].join("/"),v.push(g),b.push(Math.ceil(500*Math.random())),t&&(v.shift(),b.shift()),g=new Date(+new Date(g)+864e5)}for(var k=1;k<15;k++)y();var C={animationDuration:3e3,tooltip:{trigger:"axis"},grid:{top:80},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:"white",rotate:-30},axisLine:{lineStyle:{color:"white"}},data:v},yAxis:{axisLabel:{color:"white"},axisLine:{lineStyle:{color:"white"}},splitLine:{lineStyle:{color:"#536388",type:"dashed"}},boundaryGap:[0,"50%"],type:"value"},series:[{name:"当日攻击数量",type:"line",stack:"a",lineStyle:{color:"rgba(76,140,255,1)"},areaStyle:{color:{x:0,y:0,x2:0,y2:1,type:"linear",global:!1,colorStops:[{offset:0,color:"#4D8CFF"},{offset:1,color:"rgba(131,77,255,0.00)"}]}},symbolSize:8,itemStyle:{borderWidth:2,borderColor:"#4D8CFF"},data:[]}]},_=a("fa7d"),w=a("a905"),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_progress"},[a("span",{staticClass:"title"},[t._v(t._s(t.boxBarIP?"威胁IP TOP10":"高危应用 TOP10"))]),a("div",{staticClass:"btns"},[a("span",{class:t.boxBarIP&&"active",on:{click:function(e){return t.switchBox(!0)}}},[t._v("\n      威胁IP\n    ")]),a("span",{class:!t.boxBarIP&&"active",on:{click:function(e){return t.switchBox(!1)}}},[t._v("\n      高危应用\n    ")])]),a("div",{staticClass:"content"},[a("div",{staticClass:"roll",style:t.rollStyle},t._l(t.list,(function(e,i){return a("div",{key:e.name+i,staticClass:"row"},[a("p",[a("span",{staticClass:"link",on:{click:function(e){return t.onClick(i)}}},[t._v(t._s(e.name))]),a("span",[t._v(t._s(e.value))])]),a("div",{staticClass:"progress"},[a("div",{staticClass:"progress_inner",style:{width:e.value/t.list[0].value*100+"%"}})])])})),0)])])},A=[],S={props:["listApp","listIP"],name:"box_progress",data:function(){return{timerRefresh:null,timer:null,rollStyle:{top:0},boxBarIP:!0}},computed:{list:function(){return this.boxBarIP?this.listIP:this.listApp}},mounted:function(){this.animation()},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{onClick:function(t){console.log(t,this.boxBarIP),this.boxBarIP?this.$router.push({name:"attackTracking",query:{ip:this.listIP[t].name}}):this.$router.push({name:"attackAnalysis",query:{site_id:this.listApp[t].id}})},animation:function(){var t=this;this.timer=setInterval((function(){t.list.length>5&&(t.rollStyle.top=0===t.rollStyle.top?"-".concat(40*(t.list.length-5),"px"):0)}),15e3)},switchBox:function(t){this.boxBarIP=t,this.rollStyle.top=0}}},O=S,I=(a("d486"),a("2877")),P=Object(I["a"])(O,x,A,!1,null,"427aa63a",null),M=P.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box_table"},[a("span",{staticClass:"title"},[t._v(t._s(t.title))]),a("div",{staticClass:"scrollTable"},[t._m(0),a("transition-group",{staticClass:"body",attrs:{name:"add-animation",tag:"div"}},t._l(t.tableList,(function(e,i){return a("div",{key:i+ +new Date,staticClass:"row add-animation-item",class:i%2==0?"deep":"light"},[a("span",{staticClass:"link",on:{click:function(a){return t.onClickIP(e)}}},[t._v(t._s(e.remote_ip))]),a("span",[t._v(t._s(e.server_ip))]),a("span",[t._v(t._s(t.fmtDate("Y-M-D hh:mm:ss",e.attack_time)))]),a("span",[t._v(t._s(e.attack_type))])])})),0)],1)])},L=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header"},[a("span",[t._v("嫌疑IP")]),a("span",[t._v("访问地址")]),a("span",[t._v("攻击时间")]),a("span",[t._v("攻击类型")])])}],D={props:{title:{type:String,default:"威胁实时监控"}},data:function(){return{tableList:[]}},methods:{fmtDate:_["a"],updateTable:function(t){var e=this.tableList.map((function(t){return t["_id"]})),a=t.filter((function(t){return-1===e.indexOf(t["_id"])}));this.tableList=a.concat(this.tableList.slice(0,4))},onClickIP:function(t){this.$router.push({name:"attackTracking",query:{id:t.id,ip:t.remote_ip}})}}},N=D,j=(a("9ff2"),Object(I["a"])(N,T,L,!1,null,"bf8dd29e",null)),E=j.exports,$=a("4ec3"),B={name:"securityMonitor",components:{TOP:w["a"],PROGRESS:M,TABLE:E},data:function(){return{timer:null,timerPie:null,timerMap:null,isChina:!1,mapOpts:u,mapDataWorld:[],mapDataChina:[],pieOpts:s["a"],lineOpts:s["a"],highAttackNum:0,highAppNum:0,interceptAttackNum:0,hackersNum:0,listApp:[],listIP:[]}},created:function(){this.getData(),this.timer=setInterval(this.getData,3e4)},beforeDestroy:function(){this.timer&&clearInterval(this.timer),this.timerPie&&clearInterval(this.timerPie),this.timerMap&&clearInterval(this.timerMap),this.timer=null,this.timerPie=null,this.timerMap=null},methods:{getData:function(){var t=this;console.log("实时刷新 间隔周期30秒"),Object($["d"])($["a"].globalAttack,{startTime:"1970-01-01 00:00:00",endTime:Object(_["a"])("Y-M-D")+" 23:59:59",isChinaMap:!1}).then((function(e){e&&(t.mapDataWorld=e,t.updateMap())})),Object($["d"])($["a"].globalAttack,{startTime:"1970-01-01 00:00:00",endTime:Object(_["a"])("Y-M-D")+" 23:59:59",isChinaMap:!0}).then((function(e){e&&(t.mapDataChina=e)})),Object($["d"])($["a"].getAttackTypeAndLevel).then((function(e){return e&&t.updatePie(e)})),Object($["d"])($["a"].interceptNumber).then((function(e){return e&&(t.interceptAttackNum=e)})),Object($["d"])($["a"].hackerNumber).then((function(e){return e&&(t.hackersNum=e.hackerNum)})),Object($["d"])($["a"].getApplicationLevel).then((function(e){return e&&(t.highAppNum=e.highApplication)})),Object($["d"])($["a"].attackTrends,{interval:"MONTH"}).then((function(e){return e&&t.updateLine(e)})),Object($["d"])($["a"].getAttackInfo,{pageSize:4}).then((function(e){return e&&t.updateTable(e)})),Object($["d"])($["a"].highAttackAppTop10).then((function(e){t.listApp=e})),Object($["d"])($["a"].threatenIp).then((function(e){t.listIP=e}))},updateTable:function(t){var e=this,a=t.map((function(t){return{id:t._id,remote_ip:t.remote_ip,server_ip:t.server_ip,attack_time:t.attack_time,attack_type:t.attack_type}}));this.$nextTick((function(){e.$refs.table.updateTable(a)}))},switchMap:function(){this.isChina=!this.isChina,this.updateMap()},updateMap:function(){var t=this.isChina?this.mapDataChina:this.mapDataWorld,e=[],a=[],i=[],n=[],s=[];t.forEach((function(t){var r=t.site_address.replace("市","");r=r.replace("省","");var o=0,l=0,c=0;t["attack_address"].forEach((function(t){var a=t["attack.harm_level"],p=a.high||0,h=a.medium||0,u=a.low||0,m=[{name:r},{name:t.name}],d={name:t.name,level:"low",data:{high:p,medium:h,low:u}};o+=p,l+=h,c+=u,p>0&&t.name?(i.push(m),d.level="high",e.push(d)):h>0&&t.name?(n.push(m),d.level="medium",e.push(d)):u>0&&t.name&&(s.push(m),d.level="low")})),a.push({name:r,site:t.site_name,high:o,medium:l,low:c})}));var r=JSON.parse(JSON.stringify(u));r.geo=this.isChina?h:p,r.series.push(c(i,"high")),r.series.push(c(n,"medium")),r.series.push(l(e,a)),this.$refs.map.clear(),this.mapOpts=r,null===this.timerMap&&this.$nextTick(this.animationMap)},updatePie:function(t){if(t.attackLevel&&0===Object.keys(t.attackLevel).length)return this.pieOpts=s["a"],!1;var e=JSON.parse(JSON.stringify(f));this.highAttackNum=t.attackLevel.high||0,e.series[0].data[0].value=t.attackLevel.high||0,e.series[0].data[1].value=t.attackLevel.medium||0,e.series[0].data[2].value=t.attackLevel.low||0,e.series[1].data=d(t.attackType),this.pieOpts=e,null===this.timerPie&&this.$nextTick(this.animationPie)},animationMap:function(){var t=-1,e=this.$refs.map,a=e.options.series[2].data.length,i=function(){e.dispatchAction({type:"downplay",seriesIndex:2,dataIndex:t}),t=(t+1)%a,e.dispatchAction({type:"highlight",seriesIndex:2,dataIndex:t}),e.dispatchAction({type:"showTip",seriesIndex:2,dataIndex:t})};i(),this.timerMap=setInterval(i,5e3)},animationPie:function(){var t=-1,e=this.$refs.pie,a=e.options.series[1].data.length,i=function(){e.dispatchAction({type:"downplay",seriesIndex:1,dataIndex:t}),t=(t+1)%a,e.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:t}),e.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:t})};i(),this.timerPie=setInterval(i,5e3)},updateLine:function(t){var e=JSON.parse(JSON.stringify(C)),a=[],i=[];t.forEach((function(t){var e=new Date(t.name);a.push("".concat(e.getFullYear(),"年").concat(e.getMonth()+1,"月")),i.push(t.value)})),e.series[0].data=i,e.xAxis.data=a,this.$refs.line&&this.$refs.line.clear(),this.lineOpts=e}}},F=B,z=(a("369f"),Object(I["a"])(F,i,n,!1,null,null,null));e["default"]=z.exports},"9ff2":function(t,e,a){"use strict";var i=a("6bb1"),n=a.n(i);n.a},d486:function(t,e,a){"use strict";var i=a("e7e3"),n=a.n(i);n.a},e7e3:function(t,e,a){}}]);
//# sourceMappingURL=chunk-24f047d0.eda381de.js.map